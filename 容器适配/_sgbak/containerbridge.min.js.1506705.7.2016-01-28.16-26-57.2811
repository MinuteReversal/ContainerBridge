function BridgeLogger(){}function NotImplementException(e){this.message="Not Implement!",e&&(this.message=e)}function UnSupportedException(e){this.message=e}function ArgumentException(e){this.message=e}function IjsBridge(){}function ListenerItem(e,t){this.type="",this.listener=function(e){console.log(e)},e&&(this.type=e),t&&(this.listener=t)}function AjsBridge(){this.version="1.0",this.logger=new BridgeLogger,this.Listeners=[]}function AlipayBridge(){var e=this;e.ContainerType=ContainerType.Alipay,e._listenAlipayReady();var t=document.createElement("script");t.addEventListener("load",function(t){"undefined"==typeof AlipayJSBridge&&e.logger.write("not find AlipayJSBridge object!")}),document.querySelector("head").insertBefore(t,null),t.src=ContainerBridgeConfig.alipayJsUrl}function AndriodBridge(){var e=this;if(e.ContainerType=ContainerType.Android,e.options=null,"undefined"==typeof device)throw new Error("Not find interface");e._andriodReady()}function getQRcodeResult(e){ContainerBridge.options.complete(JSON.parse(e).QRCodeResult)}function H5Bridge(){this.ContainerType=ContainerType.PC}function IosBridge(){var e=this;e.options=null,this.ContainerType=ContainerType.iOS,window.addEventListener("load",function(){if("undefined"==typeof JSModel)throw new Error("Not find interface");e._iosReady()})}function onScanComplete(e){ContainerBridge.options.complete(e.qrValue)}function WechatBridge(){var e=this;e.ContainerType=ContainerType.Wechat;try{var t=document.createElement("script");t.addEventListener("load",function(t){"undefined"==typeof wx&&e.logger.write("Not find wechat Inerface!"),e._lisenWechatError(),e._wechatReady(),e._Config()}),document.querySelector("head").appendChild(t),t.src=ContainerBridgeConfig.wechatJsUrl}catch(n){e.logger.write(n.message)}}function BridgeFactory(){}BridgeLogger.prototype.write=function(e){ContainerBridgeConfig.debug&&(console.log(e),alert(e))};var BridgeEventType={ready:"ready"};NotImplementException.prototype=new Error,UnSupportedException.prototype=new Error,ArgumentException.prototype=new Error;var BridgeEventType={ready:"ready"},ContainerType={Wechat:"Wechat",Alipay:"Alipay",Android:"Android",WindowsPhone:"WindowsPhone",iOS:"iOS",PC:"PC"},ScanType={barCode:"barCode",qrCode:"qrCode",cardNumber:"cardNumber"};IjsBridge.prototype.extend=function(){throw new NotImplementException},IjsBridge.prototype.addEventListener=function(e,t){throw new NotImplementException},IjsBridge.prototype.dispatchEvent=function(e){throw new NotImplementException},IjsBridge.prototype.removeEventListener=function(e,t){throw new NotImplementException},IjsBridge.prototype.scan=function(e){throw new NotImplementException},AjsBridge.prototype=new IjsBridge,AjsBridge.prototype.extend=function(){for(var e,t={},n=0;e=arguments[n];n++)if(e&&"object"==typeof e)for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},AjsBridge.prototype.addEventListener=function(e,t){var n=this;n.Listeners.push(new ListenerItem(e,t))},AjsBridge.prototype.dispatchEvent=function(e){var t=this;t.Listeners.forEach(function(t,n,r){t.type===e&&t.listener(e)})},AjsBridge.prototype.removeEventListener=function(e,t){var n=this;n.Listeners.forEach(function(n,r,i){n.type===e&&n.listener===t&&i.splice(r,1)})},AjsBridge.prototype.DefaultScanOptions={scanType:ScanType.qrCode,complete:function(e){console.log(e)}},AlipayBridge.prototype=new AjsBridge,AlipayBridge.prototype._listenAlipayReady=function(){var e=this;document.addEventListener("AlipayJSBridgeReady",function(){e.dispatchEvent(BridgeEventType.ready)},!1)},AlipayBridge.prototype.scan=function(e){if(!e)throw new ArgumentException("scanOptions");var t=this,n=t.extend(t.DefaultScanOptions,e),r={type:"qr"};switch(n.scanType){case ScanType.barCode:r.type="bar";break;case ScanType.qrCode:r.type="qr";break;case ScanType.cardNumber:r.type="card"}AlipayJSBridge.call("scan",r,function(e){n.complete(e[n.scanType])})},AndriodBridge.prototype=new AjsBridge,AndriodBridge.prototype._andriodReady=function(){var e=this;e.dispatchEvent(BridgeEventType.ready)},AndriodBridge.prototype.scan=function(e){if(!e)throw new ArgumentException("options");var t=this,n=t.extend(t.DefaultScanOptions,e);if(n.scanType===ScanType.cardNumber)throw new UnSupportedException("cardNumber");t.options=n,device.scanQRcode()},H5Bridge.prototype=new AjsBridge,H5Bridge.prototype.scan=function(e){var t=this,n=t.extend(t.DefaultScanOptions,e);n.complete("Not Implement!")},IosBridge.prototype=new AjsBridge,IosBridge.prototype._iosReady=function(){var e=this;e.dispatchEvent(BridgeEventType.ready)},IosBridge.prototype.scan=function(e){if(!e)throw new ArgumentException("options");var t=this,n=t.extend(t.DefaultScanOptions,e);if(n.scanType===ScanType.cardNumber)throw new UnSupportedException("cardNumber");t.options=n,JSModel.callQrReaderView()},WechatBridge.prototype=new AjsBridge,WechatBridge.prototype._wechatReady=function(){var e=this;wx.ready(function(){e.dispatchEvent(BridgeEventType.ready)})},WechatBridge.prototype._lisenWechatError=function(){wx.error(function(e){me.logger.write(JSON.stringify(e))})},WechatBridge.prototype._Config=function(){var e=this,t=new XMLHttpRequest;try{t.open("GET",ContainerBridgeConfig.wechatSignatureApiUrl+"?appid="+ContainerBridgeConfig.wechatAppID+"&secret="+ContainerBridgeConfig.wechatAppSecret+"&url="+encodeURIComponent(location.href.split("#")[0])+"&_timestamp="+Date.now()),t.setRequestHeader("Accept","application/json"),t.onreadystatechange=function(n){if(4===t.readyState&&200===t.status)try{var r=t.responseText;e.logger.write(r);var i=JSON.parse(r),o={debug:ContainerBridgeConfig.debug,appId:i.AppId,timestamp:i.TimeStamp,nonceStr:i.Noncestr,signature:i.Signature,jsApiList:ContainerBridgeConfig.wechatAPIList};e.logger.write(JSON.stringify(o)),wx.config(o)}catch(a){e.logger.write(a.message)}},t.send()}catch(n){e.logger.write("xhr Error:"+n.message)}},WechatBridge.prototype.scan=function(e){var t=this,n=t.extend(t.DefaultScanOptions,e),r={needResult:1,scanType:["qrCode","barCode"],success:function(e){n.complete(e.resultStr)},fail:function(e){},complete:function(e){},cancel:function(e){}};if(n.scanType===ScanType.cardNumber)throw new UnSupportedException("Wechat UnSupportedException cardNumber");r.scanType=n.scanType,wx.scanQRCode(r)},BridgeFactory.prototype.Create=function(e){var t;return t=/MicroMessenger/gi.test(e)?new WechatBridge:/AlipayClient/gi.test(e)?new AlipayBridge:/AndroidShell/gi.test(e)?new AndriodBridge:/iOSshell/gi.test(e)?new IosBridge:new H5Bridge};var ContainerBridge=null;try{ContainerBridge=(new BridgeFactory).Create(window.navigator.userAgent)}catch(e){(new BridgeLogger).write(message)}